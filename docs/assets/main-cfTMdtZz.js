import{r as t,j as a,Y as de,D as J,X as ce,M as ue,c as he,d as fe,V as me}from"./vendor-react-B3r_Q0wt.js";import{$ as pe,a0 as ge,t as G,a1 as we,_ as $,K as be,a2 as ye,d as xe,a3 as Se,N,a4 as q,a5 as Q,a6 as ve,a7 as ke,a8 as Ae,a9 as Te,aa as je,ab as Ie,ac as Ee,ad as Ce,ae as Me}from"./bikram-CRjDGngL.js";import{D as Ne,A as De}from"./pages-J3vtqM7L.js";import"./index-CeR1JVh_.js";import{l as Le,m as Re,a as Pe,b as Be}from"./vendor-leaflet-Ch3uxlbW.js";const Ye=()=>{const[e,n]=t.useState("light");return t.useEffect(()=>{const m=localStorage.getItem("theme")||"light";n(m),document.documentElement.classList.toggle("dark",m==="dark")},[]),{theme:e,toggleTheme:()=>{const l=e==="light"?"dark":"light";n(l),localStorage.setItem("theme",l),document.documentElement.classList.toggle("dark",l==="dark")},resetTheme:()=>{localStorage.removeItem("theme"),n("light"),document.documentElement.classList.toggle("dark",!1)}}},Ve=()=>{const[e,n]=t.useState("tabs"),[S,h]=t.useState("topbar");return t.useEffect(()=>{const o=localStorage.getItem("menuStyle");n(o||"tabs");const d=localStorage.getItem("desktopLayoutStyle");h(d||"topbar")},[]),{menuStyle:e,desktopLayoutStyle:S,handleSetMenuStyle:o=>{n(o),localStorage.setItem("menuStyle",o)},handleSetDesktopLayoutStyle:o=>{h(o),localStorage.setItem("desktopLayoutStyle",o)},resetLayoutSettings:()=>{localStorage.removeItem("menuStyle"),localStorage.removeItem("desktopLayoutStyle"),n("tabs"),h("topbar")}}};function Z(e={}){const{immediate:n=!1,onNeedRefresh:S,onOfflineReady:h,onRegistered:l,onRegisteredSW:m,onRegisterError:c}=e;let o,d;const p=async(s=!0)=>{await d};async function g(){if("serviceWorker"in navigator){if(o=await pe(async()=>{const{Workbox:s}=await import("./vendor-other-DQJqTIja.js").then(i=>i.w);return{Workbox:s}},[],import.meta.url).then(({Workbox:s})=>new s("./sw.js",{scope:"./",type:"classic"})).catch(s=>{c?.(s)}),!o)return;o.addEventListener("activated",s=>{(s.isUpdate||s.isExternal)&&window.location.reload()}),o.addEventListener("installed",s=>{s.isUpdate||h?.()}),o.register({immediate:n}).then(s=>{m?m("./sw.js",s):l?.(s)}).catch(s=>{c?.(s)})}}return d=g(),p}const We=()=>{const[e,n]=t.useState(!1),[S,h]=t.useState(!1),[l,m]=t.useState(()=>localStorage.getItem("pwa_installed")==="true"),[c,o]=t.useState(null);return t.useEffect(()=>{Z({immediate:!0})},[]),t.useEffect(()=>{const p=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone;if(n(!!p),p){m(!0);return}const g=()=>{localStorage.setItem("pwa_installed","true"),m(!0),h(!1)};window.addEventListener("appinstalled",g),"getInstalledRelatedApps"in navigator&&navigator.getInstalledRelatedApps().then(i=>{i.length>0&&(localStorage.getItem("pwa_installed")!=="true"&&localStorage.setItem("pwa_installed","true"),m(!0))});const s=i=>{i.preventDefault(),localStorage.removeItem("pwa_installed"),m(!1),o(i),h(!0)};return window.addEventListener("beforeinstallprompt",s),()=>{window.removeEventListener("appinstalled",g),window.removeEventListener("beforeinstallprompt",s)}},[]),{isStandalone:e,canInstall:S,isInstalled:l,deferredPrompt:c,handleInstallClick:async()=>{c&&(c.prompt(),await c.userChoice,o(null),h(!1))}}},_e=()=>{const[e]=t.useState(ge()),[n]=t.useState(()=>G(e)),[S,h]=t.useState(null);t.useEffect(()=>{try{const x=we(e,27.7172,85.324,5.75);"error"in x?$(`Error from calculate:'${x.error}`,"error",2e3):h(x)}catch(x){$(`Error calculating today details:${x}`,"error",2e3)}},[]);const[l,m]=t.useState("bs"),[c,o]=t.useState(n.year),[d,p]=t.useState(n.monthIndex),[g,s]=t.useState(e.getFullYear()),[i,v]=t.useState(e.getMonth()),D=t.useMemo(()=>l==="bs"?c:g,[l,c,g]),b=t.useMemo(()=>l==="bs"?d:i,[l,d,i]),k=t.useCallback(()=>{o(n.year),p(n.monthIndex),s(e.getFullYear()),v(e.getMonth())},[e,n]),A=t.useCallback(y=>{if(y===l)return;const u=g===e.getFullYear()&&i===e.getMonth(),T=c===n.year&&d===n.monthIndex;if(y==="bs"&&u||y==="ad"&&T)k();else if(y==="bs"){const x=g??e.getFullYear(),P=be(x,i,12),E=ye(P),C=G(E);C.year===0||!C.year?k():(o(C.year),p(C.monthIndex))}else if(c===null)k();else{const x=xe(c,d,18);s(x.getUTCFullYear()),v(x.getUTCMonth())}m(y)},[l,g,i,c,d,e,n,k]),L=t.useCallback(y=>{if(l==="bs"){const u=y==="prev"?d-1:d+1;u<0?(p(11),o(T=>(T??n.year)-1)):u>11?(p(0),o(T=>(T??n.year)+1)):p(u)}else{const u=y==="prev"?i-1:i+1;u<0?(v(11),s(T=>(T??e.getFullYear())-1)):u>11?(v(0),s(T=>(T??e.getFullYear())+1)):v(u)}},[l,d,i,e,n]),I=t.useCallback(y=>{l==="bs"?o(u=>(u??n.year)+(y==="next"?1:-1)):s(u=>(u??e.getFullYear())+(y==="next"?1:-1))},[l,e,n]);return{activeSystem:l,currentBsYear:c,currentBsMonth:d,currentAdYear:g,currentAdMonth:i,currentYear:D,currentMonth:b,switchSystem:A,goToToday:k,changeMonth:L,changeYear:I,setCurrentBsYear:o,setCurrentBsMonth:p,setCurrentAdYear:s,setCurrentAdMonth:v,initialToday:e,initialTodayBs:n,todayDetails:S}},Oe=()=>{const[e,n]=t.useState(()=>{if(typeof window>"u")return"calendar";const r=window.location.pathname;if(r.includes("/bs")||r.includes("/ad"))return"day-detail";const w=window.location.hash.replace("#","");if(!w){const j=new URLSearchParams(window.location.search).get("activeView");return j||"calendar"}return w.startsWith("bs?")||w.startsWith("ad?")?"day-detail":w.split("/")[0]||"calendar"}),S=t.useRef("calendar"),[h,l]=t.useState(null),[m,c]=t.useState(!1),[o,d]=t.useState(!1),[p,g]=t.useState(!1),[s,i]=t.useState(!1),[v,D]=t.useState(!1),b=t.useRef(null),k=t.useRef(null),[A,L]=t.useState(!1),I=t.useRef(null),y=t.useRef(0),[u,T]=t.useState(!1);t.useEffect(()=>{let r=null,w=0;const B=25,M=()=>{w++,typeof window.Android<"u"&&typeof window.Android.isAndroidApp=="function"?(T(!0),r&&clearInterval(r)):w>=B&&r&&clearInterval(r)};return M(),u||(r=window.setInterval(M,2e3)),()=>{r&&clearInterval(r)}},[]),t.useEffect(()=>{if(u)return;let r="";if(e!=="calendar"){if(e==="day-detail")return;r=e,e==="kundali"&&s?r+="/result":e==="dharma"&&v&&(r+="/section")}const w=window.location.hash.replace("#",""),M=(window.location.pathname.includes("/bs")||window.location.pathname.includes("/ad"))&&e!=="day-detail";if(w!==r||M){let j=r?`#${r}`:window.location.pathname;M?j=`/${r?"#"+r:""}`:e==="calendar"&&(j=window.location.pathname);const V=S.current!==e,_=S.current!=="calendar"&&e!=="calendar",W=w===""||r.startsWith(w)&&r!==w;V&&_?window.history.replaceState({view:e},"",j):!V&&!W?window.history.replaceState({view:e},"",j):window.history.pushState({view:e},"",j)}S.current=e},[e,s,v,u]),t.useEffect(()=>{const r=w=>{o&&w.key==="Backspace"&&(w.preventDefault(),d(!1))};return o&&window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[o]);const x=t.useCallback(()=>m?(c(!1),!0):p?(g(!1),!0):o?(d(!1),!0):e==="kundali"&&s&&b.current?(b.current(),!0):e==="dharma"&&v&&k.current?(k.current(),!0):u&&e!=="calendar"?(n("calendar"),!0):!1,[m,p,o,e,s,v,u]),R=t.useRef(x);t.useEffect(()=>{R.current=x},[x]),t.useEffect(()=>{const r=()=>{y.current=0,L(!1),I.current&&(clearTimeout(I.current),I.current=null)};if(u)return window.handleBackPress=()=>R.current()?(r(),!0):(y.current+=1,y.current===1?(L(!0),navigator.vibrate&&navigator.vibrate(50),I.current=window.setTimeout(r,2e3),!0):(typeof window.Android?.exitApp=="function"&&window.Android.exitApp(),!1)),()=>{r()};{const w=()=>{if(R.current()){if(window.location.hash.replace("#","")===e)return;if(window.location.hash.replace("#","")!==(e==="calendar"?"":e)){const H=e==="calendar"?window.location.pathname:`#${e}`;setTimeout(()=>{window.history.replaceState({view:e},"",H)},10)}return}const j=window.location.hash.replace("#","").split("/")[0];n(j===""?"calendar":j)};return window.addEventListener("popstate",w),()=>window.removeEventListener("popstate",w)}},[u,e]);const P=r=>{l(r),c(!0)},E=t.useCallback(r=>{b.current=r},[]),C=t.useCallback(r=>{k.current=r},[]);return{activeView:e,setActiveView:n,selectedDate:h,isModalOpen:m,setIsModalOpen:c,isMenuOpen:o,setIsMenuOpen:d,isAboutOpen:p,setIsAboutOpen:g,isKundaliResultsVisible:s,setIsKundaliResultsVisible:i,setKundaliBackAction:E,isDharmaResultsVisible:v,setIsDharmaResultsVisible:D,setDharmaBackAction:C,showExitToast:A,handleDayClick:P,isAndroidWebView:u}},Ue=(e,n)=>{const[S,h]=t.useState(!1),[l,m]=t.useState(null),[c,o]=t.useState(null),[d,p]=t.useState(!1),[g,s]=t.useState(null);return t.useEffect(()=>{typeof window.Android<"u"&&typeof window.Android.openWidgetSettings=="function"&&h(!0)},[]),t.useEffect(()=>{const b=k=>{if(k?.preventDefault?.(),e){n(!1);return}if(d)window.Android?.exitApp?window.Android.exitApp():window.history.length>1?window.history.back():window.close();else{p(!0);const A=window.setTimeout(()=>p(!1),2e3);s(A)}};return window.addEventListener("popstate",b),document.addEventListener("backbutton",b),()=>{window.removeEventListener("popstate",b),document.removeEventListener("backbutton",b),g&&clearTimeout(g)}},[e,d,g,n]),{isAndroidApp:S,showExitToast:d,handleTouchStart:b=>{m(b.touches[0].clientX),o(null)},handleTouchMove:b=>o(b.touches[0].clientX),handleTouchEnd:()=>{if(!l||!c)return;const b=c-l;b>60&&l<50?n(!0):b<-60&&e&&n(!1),m(null),o(null)}}},$e=()=>{const{theme:e,toggleTheme:n,resetTheme:S}=Ye(),{menuStyle:h,desktopLayoutStyle:l,handleSetMenuStyle:m,handleSetDesktopLayoutStyle:c,resetLayoutSettings:o}=Ve(),{isStandalone:d,canInstall:p,handleInstallClick:g}=We(),{activeView:s,setActiveView:i,selectedDate:v,isModalOpen:D,setIsModalOpen:b,isMenuOpen:k,setIsMenuOpen:A,isAboutOpen:L,setIsAboutOpen:I,handleDayClick:y,setIsKundaliResultsVisible:u,setKundaliBackAction:T,setIsDharmaResultsVisible:x,setDharmaBackAction:R,showExitToast:P}=Oe(),{activeSystem:E,currentYear:C,currentMonth:r,currentBsYear:w,currentBsMonth:B,currentAdYear:M,currentAdMonth:j,switchSystem:V,goToToday:_,changeMonth:W,changeYear:F,setCurrentBsYear:X,setCurrentAdYear:H,setCurrentBsMonth:ee,setCurrentAdMonth:te,initialToday:z,initialTodayBs:ae,todayDetails:K}=_e(),{isAndroidApp:se,handleTouchStart:ne,handleTouchMove:re,handleTouchEnd:oe}=Ue(k,A),le=()=>{S(),o(),$.info("Settings reset to default",2e3)};t.useEffect(()=>{const Y=new URLSearchParams(window.location.search).get("activeView");Y?(i(Y),window.history.replaceState({},"","/")):(window.location.hash&&(window.location.hash.startsWith("#bs?")||window.location.hash.startsWith("#ad?"))||window.location.pathname.endsWith("/bs")||window.location.pathname.endsWith("/bs.html")||window.location.pathname.endsWith("/ad")||window.location.pathname.endsWith("/ad.html"))&&i("day-detail")},[i]),t.useEffect(()=>{P&&$.info("Press back again to exit",2e3)},[P]);const ie=()=>y(z);return a.jsxs("div",{className:`min-h-screen flex flex-col bg-slate-100 dark:bg-gray-800 text-gray-900 dark:text-gray-100 transition-colors relative ${l==="sidebar"?"md:flex-row":""} ${e==="dark"?"dark":""}`,onTouchStart:ne,onTouchMove:re,onTouchEnd:oe,children:[l==="topbar"&&a.jsx("div",{className:"w-full z-30 print:hidden hidden md:block border-b border-gray-200 dark:border-gray-700",children:a.jsx(Se,{activeView:s,onNavigate:f=>{f==="about"?I(!0):i(f)},showInstall:!d&&p,onInstallClick:g})}),a.jsx("header",{className:"px-4 py-2 dark:border-gray-700 bg-slate-200 dark:bg-gray-800 z-30 md:hidden",children:a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[h==="slide"&&a.jsx("button",{onClick:()=>A(!0),className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",children:a.jsx(de,{className:"w-5 h-5"})}),a.jsx("h1",{className:"text-lg sm:text-xl font-semibold",children:N.Nepdate_calendar})]}),h==="tabs"&&!d&&p&&a.jsxs("button",{onClick:g,className:"px-3 py-2 text-left text-xs rounded bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(J,{className:"w-5 h-5"})," ",a.jsx("span",{children:N.installApp})]})]})}),k&&a.jsx("div",{className:"fixed inset-0 bg-black/40 z-40 md:hidden",onClick:()=>A(!1)}),a.jsx("aside",{className:`fixed top-0 left-0 z-50 h-full bg-slate-200 dark:bg-gray-800 shadow-xl transform transition-transform duration-300 ease-in-out
          ${k?"translate-x-0":"-translate-x-full"}
          ${l==="sidebar"?"md:translate-x-0 md:sticky md:h-screen md:w-56":"md:hidden w-64"}`,children:a.jsxs("div",{className:"flex flex-col h-full p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"Menu"}),a.jsx("button",{onClick:()=>A(!1),className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 md:hidden",children:a.jsx(ce,{className:"w-5 h-5"})})]}),a.jsxs("nav",{className:"flex flex-col space-y-3 text-gray-800 dark:text-gray-200",children:[q.map(f=>a.jsxs("button",{onClick:()=>{f.key==="about"?I(!0):i(f.key),A(!1)},className:`px-3 py-2 flex items-center gap-2 rounded hover:bg-gray-300 dark:hover:bg-gray-700 ${s===f.key?"bg-gray-300 dark:bg-gray-700 font-medium":""}`,children:[f.icon," ",f.label]},f.key)),!d&&p&&a.jsxs("button",{onClick:()=>{g(),A(!1)},className:"px-3 py-2 flex items-center gap-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:[a.jsx(J,{className:"w-4 h-4"})," ",N.installApp]}),a.jsxs("button",{onClick:()=>{n(),A(!1)},className:"px-3 py-2 flex items-center gap-2 rounded hover:bg-gray-300 dark:hover:bg-gray-700",children:[e==="light"?a.jsx(ue,{className:"w-4 h-4"}):a.jsx(he,{className:"w-4 h-4"})," ",e==="light"?N.darkMode:N.lightMode]}),a.jsx("hr",{className:"border-gray-300 dark:border-gray-600 my-2"}),a.jsxs("button",{onClick:()=>{Q(),A(!1)},className:"px-3 py-2 flex items-center gap-2 rounded text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900/50",children:[a.jsx(fe,{className:"w-4 h-4"})," Clear Cache & Reload"]})]}),a.jsxs("div",{className:"mt-auto text-xs text-gray-500 dark:text-gray-400 border-t border-gray-200 dark:border-gray-700 pt-4",children:["Â© ",new Date().getFullYear()," ",N.project]})]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx("div",{className:`h-full overflow-auto px-4 md:px-6 max-w-7xl xl:max-w-6xl mx-auto w-full ${h==="tabs"?"pb-2 md:pb-6":"pb-20 md:pb-6"}`,children:s==="calendar"?a.jsxs(a.Fragment,{children:[a.jsx(ve,{activeSystem:E,bsYear:w,bsMonth:B,adYear:M,adMonth:j,onSystemChange:V,onTodayClick:_,theme:e,onThemeToggle:n,todayDetails:K}),a.jsxs("main",{className:"min-h-[60vh] pb-20 md:grid md:grid-cols-12 md:gap-x-6",children:[a.jsx("aside",{className:"hidden md:block md:col-span-4",children:a.jsx(ke,{todayAd:z,todayBs:ae,todayDetails:K,onShowDetailsClick:ie})}),a.jsxs("div",{className:"md:col-span-8 flex flex-col",children:[a.jsx(Ae,{activeSystem:E,currentYear:C,currentMonth:r,onYearChange:f=>E==="bs"?X(f):H(f),onMonthChange:f=>E==="bs"?ee(f):te(f),onPrevMonth:()=>W("prev"),onNextMonth:()=>W("next"),onPrevYear:()=>F("prev"),onNextYear:()=>F("next")}),a.jsx(Te,{activeSystem:E,currentYear:C,currentMonth:r,onDayClick:y}),a.jsx(je,{activeSystem:E,currentYear:C,currentMonth:r})]})]})]}):s==="day-detail"?a.jsx(Ne,{onBack:()=>{window.history.pushState({},"","/"),i("calendar")}}):(()=>{const f=q.find(Y=>Y.key===s);if(f&&f.page){const Y=f.page,O={onBack:()=>i("calendar")};let U={...O};return s==="settings"?U={...O,currentTheme:e,onThemeChange:n,currentMenuStyle:h,onMenuStyleChange:m,currentDesktopLayoutStyle:l,onDesktopLayoutStyleChange:c,onResetSettings:le,isAndroidApp:se,onReloadApp:Q}:s==="kundali"?U={...O,setIsKundaliResultsVisible:u,setKundaliBackAction:T}:s==="dharma"&&(U={...O,setIsDharmaResultsVisible:x,setDharmaBackAction:R}),a.jsx(t.Suspense,{fallback:a.jsx("div",{className:"flex justify-center items-center pb-20 min-h-[60vh]",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}),children:a.jsx(Y,{...U})})}return null})()})}),h==="slide"&&a.jsx("div",{className:"fixed bottom-0 left-0 right-0 w-full bg-slate-200 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 z-50 print:hidden md:hidden",children:a.jsx(Ie,{})}),h==="tabs"&&a.jsx("div",{className:"md:hidden print:hidden",children:a.jsx(Ee,{activeView:s,onNavigate:f=>{f==="about"?I(!0):i(f)},theme:e,onThemeToggle:n,themeLabel:e==="light"?N.darkMode:N.lightMode})}),a.jsx(Ce,{date:v,isOpen:D,onClose:()=>b(!1),activeSystem:E}),L&&a.jsx(De,{setIsAboutOpen:I}),a.jsx(Me,{})]})};Le.Icon.Default.mergeOptions({iconUrl:Be,shadowUrl:Pe,iconRetinaUrl:Re});Z({onNeedRefresh(){confirm("A new version is available. Reload to update?")&&window.location.reload()},onOfflineReady(){console.log("App ready to work offline")}});me.createRoot(document.getElementById("root")).render(a.jsx(t.StrictMode,{children:a.jsx($e,{})}));
